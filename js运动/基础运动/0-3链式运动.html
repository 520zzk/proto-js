<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>无标题文档</title>
<style>
#div1 {width: 100px; height: 100px; background: red; position: absolute; left: 50px; top: 100px;}

</style>
<script>
//统一
window.onload = function() {
	
	var oDiv1 = document.getElementById('div1');
	

	
	//alert(css(oImg, 'opacity'));	//currentStyle -> getAttribute()
	//alert(oImg.currentStyle['miaov'])
	
oDiv1.onclick=function(){
    //下面运动会清除上面的定时器

    // startMove(this,"width",200,10);
    // startMove(this,"height",200,10);
    startMove(this,{
        width:300,
        },function(){
            startMove(this,{
                height:400
            },10)
        });
}
	
	function startMove(obj, json, iSpeed,fu) {
        /*对象，属性范围，速度（透明度按100来）*/

		clearInterval(obj.iTimer);
        var iCur=0;
        var iSpeed=iSpeed;
		obj.iTimer = setInterval(function(){

            /*每走一下就把运动属性推动一次*/
            var t=true;
            
            for(var attr in json){
                var iTarget=json[attr];
                if(attr=="opacity"){
                            iCur = Math.round(css( obj, 'opacity' ) * 100);	//29.999900000045
                        }
                        else {
                            iCur=parseInt(css(obj,attr));
                         
                            }
                            console.log(iTarget,iCur);
                            iSpeed=(iTarget-iCur)/5;
                            iSpeed=iSpeed>0 ? Math.ceil(iSpeed) : Math.floor(iSpeed);
                        if(iCur!=iTarget){/*如果还有没到目标的*/
                           t=false;
                           if(attr=='opacity')
                                {
                                    obj.style.opacity = (iCur + iSpeed) / 100;
                                    obj.style.filter = 'alpha(opacity='+ (iCur + iSpeed) +')';
                                }else{
                                    obj.style[attr]= iCur + iSpeed +'px';
                                   
                                
                                }
                        }
            }
        /*查看所有的属性是不是都到了目标点*/
		if(t){
            clearInterval(obj.iTimer);
            fu&&fu.call(obj);
           
        }




           }, 1000/60);
	}
	

	
	function css(obj, attr) {
		if (obj.currentStyle) {
			return obj.currentStyle[attr];
		} else {
			return getComputedStyle(obj, false)[attr];
		}
	}
	
}
</script>
</head>

<body>
	<div id="div1">
    
    </div>
    
  
</body>
</html>
